# Generated by extendr: Do not edit by hand

# nolint start

#
# This file was created with the following call:
#   .Call("wrap__make_phylo2vec_wrappers", use_symbols = TRUE, package_name = "phylo2vec")

#' @usage NULL
#' @useDynLib phylo2vec, .registration = TRUE
NULL

#' Add a leaf to a phylo2vec vector
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @param leaf The leaf to add (0-indexed)
#' @param branch The branch to attach the new leaf to (0-indexed)
#' @return New vector with the added leaf
#' @export
add_leaf <- function(vector, leaf, branch) .Call(wrap__add_leaf, vector, leaf, branch)

#' Apply an integer-taxon label mapping (label_mapping)
#' to an integer-based newick (where leaves are integers)
#' and produce a mapped Newick (where leaves are strings (taxa))
#'
#' For more details, see `create_label_mapping`.
#'
#' Note 1: this does not check for the validity of the Newick string.
#'
#' Note 2: the parent nodes are removed from the output,
#' but the branch lengths/annotations are kept.
#'
#' @param newick Newick representation of a tree with integer labels
#' @param label_mapping_list A vector where the index corresponds to the integer label
#' @return Newick with string labels
#' @export
apply_label_mapping <- function(newick, label_mapping_list) .Call(wrap__apply_label_mapping, newick, label_mapping_list)

#' Validate a phylo2vec matrix
#'
#' Raises an error if the matrix is invalid.
#'
#' @param vector phylo2vec matrix representation of a tree (with branch lengths)
#' @export
check_m <- function(vector) invisible(.Call(wrap__check_m, vector))

#' Validate a phylo2vec vector
#'
#' Raises an error if the vector is invalid.
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @export
check_v <- function(vector) invisible(.Call(wrap__check_v, vector))

cophenetic_from_matrix <- function(matrix, unrooted) .Call(wrap__cophenetic_from_matrix, matrix, unrooted)

cophenetic_from_vector <- function(vector, unrooted) .Call(wrap__cophenetic_from_vector, vector, unrooted)

#' Create an integer-taxon label mapping (label_mapping)
#' from a string-based newick (where leaves are strings)
#' and produce a mapped integer-based newick (where leaves are integers).
#'
#' Note 1: this does not check for the validity of the Newick string.
#'
#' Note 2: the parent nodes are removed from the output,
#' but the branch lengths/annotations are kept.
#'
#' @param newick Newick representation of a tree with string labels
#' @return A list with two elements:
#' - `newick`: Newick with integer labels
#' - `mapping`: A vector where the index corresponds to the integer label
#' @export
create_label_mapping <- function(newick) .Call(wrap__create_label_mapping, newick)

#' Find the number of leaves in a Newick string
#'
#' @param newick Newick representation of a tree
#' @return Number of leaves
#' @export
find_num_leaves <- function(newick) .Call(wrap__find_num_leaves, newick)

#' Convert an ancestry matrix to a phylo2vec vector
#'
#' @param matrix Ancestry representation (shape: [n_leaves - 1, 3])
#' @return phylo2vec vector representation
#' @export
from_ancestry <- function(matrix) .Call(wrap__from_ancestry, matrix)

#' Convert an edge list to a phylo2vec vector
#'
#' @param edges Edge list representation (shape: [2*(n_leaves - 1), 2])
#' @return phylo2vec vector representation
#' @export
from_edges <- function(edges) .Call(wrap__from_edges, edges)

#' Convert a pairs matrix to a phylo2vec vector
#'
#' @param pairs Pairs representation (shape: [n_leaves - 1, 2])
#' @return phylo2vec vector representation
#' @export
from_pairs <- function(pairs) .Call(wrap__from_pairs, pairs)

#' Get the first recent common ancestor between two nodes in a phylo2vec tree
#' node1 and node2 can be leaf nodes (0 to n_leaves) or internal nodes (n_leaves to 2*(n_leaves-1)).
#' Similar to ape's `getMRCA` function in R (for leaf nodes)
#' and ETE's `get_common_ancestor` in Python (for all nodes), but for phylo2vec vectors.
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @param node1 The first node (0-indexed)
#' @param node2 The second node (0-indexed)
#' @return The common ancestor node (0-indexed)
#' @export
get_common_ancestor <- function(vector, node1, node2) .Call(wrap__get_common_ancestor, vector, node1, node2)

#' Check if a newick string has branch lengths
#'
#' @param newick Newick representation of a tree
#' @return TRUE if the newick has branch lengths, FALSE otherwise
#' @export
has_branch_lengths <- function(newick) .Call(wrap__has_branch_lengths, newick)

incidence_coo <- function(input_vector) .Call(wrap__incidence_coo, input_vector)

incidence_csc <- function(input_vector) .Call(wrap__incidence_csc, input_vector)

incidence_csr <- function(input_vector) .Call(wrap__incidence_csr, input_vector)

incidence_dense <- function(input_vector) .Call(wrap__incidence_dense, input_vector)

pre_precision_from_matrix <- function(matrix) .Call(wrap__pre_precision_from_matrix, matrix)

pre_precision_from_vector <- function(vector) .Call(wrap__pre_precision_from_vector, vector)

#' Produce an ordered version (i.e., birth-death process version)
#' of a phylo2vec vector using the Queue Shuffle algorithm.
#'
#' Queue Shuffle ensures that the output tree is ordered,
#' while also ensuring a smooth path through the space of orderings
#'
#' for more details, see https://doi.org/10.1093/gbe/evad213
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @param shuffle_cherries If true, the algorithm will randomly shuffle the order of cherries (i.e., pairs of leaves)
#' @return A list with two elements:
#' - `v`: The ordered phylo2vec vector
#' - `mapping`: A mapping of the original labels to the new labels
#' @export
queue_shuffle <- function(vector, shuffle_cherries) .Call(wrap__queue_shuffle, vector, shuffle_cherries)

#' Remove parent labels from the Newick string
#'
#' @param newick Newick representation of a tree with branch lengths
#' @return Newick string without branch lengths
#' @export
remove_branch_lengths <- function(newick) .Call(wrap__remove_branch_lengths, newick)

#' Remove parent labels from the Newick string
#'
#' @param newick Newick representation of a tree with parent labels
#' @return Newick string without parent labels
#' @export
remove_parent_labels <- function(newick) .Call(wrap__remove_parent_labels, newick)

#' Remove a leaf from a phylo2vec vector
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @param leaf The leaf to remove (0-indexed)
#' @return A list with two elements:
#' - `v`: New vector with the removed leaf
#' - `branch`: The branch the removed leaf was attached to (0-indexed)
#' @export
remove_leaf <- function(vector, leaf) .Call(wrap__remove_leaf, vector, leaf)

#' Sample a random tree with branch lengths via phylo2vec
#'
#' @param n_leaves Number of leaves (must be at least 2)
#' @param ordered Whether to sample an ordered tree
#' @return A phylo2vec matrix representing the sampled tree with branch lengths (shape: [n_leaves - 1, 3])
#' @export
sample_matrix <- function(n_leaves, ordered) .Call(wrap__sample_matrix, n_leaves, ordered)

#' Sample a random tree topology via phylo2vec
#'
#' In ordered trees, leaf i grows from a sister leaf (i.e., attaches to a leaf branch j <= i)
#' In unordered trees, leaf i grows from any node (i.e., attaches to any branch j <= 2*i)
#'
#' @param n_leaves Number of leaves (must be at least 2)
#' @param ordered Whether to sample an ordered tree
#' @return A phylo2vec vector representing the sampled tree topology (length: n_leaves - 1)
#' @export
sample_vector <- function(n_leaves, ordered) .Call(wrap__sample_vector, n_leaves, ordered)

#' Get the ancestry matrix of a phylo2vec vector
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @return Ancestry representation (shape: [n_leaves - 1, 3])
#' @export
to_ancestry <- function(vector) .Call(wrap__to_ancestry, vector)

#' Get the edge list of a phylo2vec vector
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @return Edge list representation (shape: [2*(n_leaves - 1), 2])
#' @export
to_edges <- function(vector) .Call(wrap__to_edges, vector)

to_newick_from_matrix <- function(matrix) .Call(wrap__to_newick_from_matrix, matrix)

to_newick_from_vector <- function(vector) .Call(wrap__to_newick_from_vector, vector)

#' Get pairs from a phylo2vec vector
#'
#' @param vector phylo2vec vector representation of a tree topology
#' @return Pairs representation (shape: [n_leaves - 1, 2])
#' @export
to_pairs <- function(vector) .Call(wrap__to_pairs, vector)

to_matrix <- function(newick) .Call(wrap__to_matrix, newick)

to_vector <- function(newick) .Call(wrap__to_vector, newick)

vcov_from_matrix <- function(matrix) .Call(wrap__vcov_from_matrix, matrix)

vcov_from_vector <- function(vector) .Call(wrap__vcov_from_vector, vector)


# nolint end
